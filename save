
all:
	if [ $(grep "tlouro-c.42.fr" /etc/hosts) ]; then \
	sudo cp /etc/hosts /etc/host_temporary \
	sudo hostname -i | awk '{print $1 "       tlouro-c.42.fr"}' | sudo tee -a /etc/hosts >/dev/null; fi
	sudo mkdir -p /home/tlouro-c/data/wordpress
	sudo mkdir -p /home/tlouro-c/data/mariadb
	docker compose --file srcs/docker-compose.yml up --build --detach

up:
	docker compose --file srcs/docker-compose.yml up --build --detach

shutdown:
	docker compose --file srcs/docker-compose.yml down

fclean:
	if [ -e /etc/host_temporary ]; then \
	sudo cp /etc/host_temporary /etc/hosts && sudo rm /etc/host_temporary; fi
	docker ps -q | xargs -r docker stop
	docker ps -qa | xargs -r docker rm
	docker images -qa | xargs -r docker rmi 
	docker network ls -q | grep "docker-network" | xargs -r docker network rm >/dev/null 2>&1
	docker volume ls -q | xargs -r docker volume rm >/dev/null 2>&1
#	sudo rm -rf /home/tlouro-c/data

re: fclean all
